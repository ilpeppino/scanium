# =============================================================================
# Scanium Smoke Test Monitor - NAS Deployment
# =============================================================================
# Lightweight container that runs smoke tests every 5 minutes.
# Logs results to /volume1/docker/scanium/logs/smoke.log
#
# Usage:
#   docker-compose -f docker-compose.nas.monitor.yml up -d
# =============================================================================

version: "3.8"

services:
  smoke-monitor:
    image: alpine:3.19
    container_name: scanium-smoke-monitor
    restart: unless-stopped
    volumes:
      - /volume1/docker/scanium/repo/scripts/ops:/scripts:ro
      - /volume1/docker/scanium/logs:/logs
    environment:
      - LOG_DIR=/logs
      - SMOKE_INTERVAL=300
    command: >
      sh -c "apk add --no-cache curl bash &&
             /bin/bash /scripts/smoke-loop.sh"
    mem_limit: 32m
